<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.7.0/css/all.css" >
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body>
<div class="container my-3">
	<div class="row mb-3">
		<div class="col">탭 전환</div>
	</div>
	<div class="row mb-3">
		<div class="col">
			<ul class="nav nav-tabs" id="myTab" role="tablist">
  				<li class="nav-item" role="presentation">
    				<button class="nav-link" id="home-tab" data-bs-toggle="tab" data-bs-target="#home" type="button" role="tab" aria-controls="home" aria-selected="false">Home</button>
  				</li>
  				<li class="nav-item" role="presentation">
    				<button class="nav-link" id="profile-tab" data-bs-toggle="tab" data-bs-target="#profile" type="button" role="tab" aria-controls="profile" aria-selected="false">Profile</button>
  				</li>
  				<li class="nav-item" role="presentation">
    				<button class="nav-link" id="contact-tab" data-bs-toggle="tab" data-bs-target="#contact" type="button" role="tab" aria-controls="contact" aria-selected="false">Contact</button>
  				</li>
			</ul>
			<div class="tab-content mt-3" id="myTabContent">
  				<div class="tab-pane fade" id="home" role="tabpanel" aria-labelledby="home-tab">
  					<h3>약관동의 화면</h3>
  					<div class="mt-3">
  						<button id="btn-go-level2" class="btn btn-primary">다음</button>
  					</div>
  				</div>
  				<div class="tab-pane fade" id="profile" role="tabpanel" aria-labelledby="profile-tab">
  					<h3>회원가입 화면</h3>
  					<div class="mt-3">
  						<button id="btn-go-level3" class="btn btn-primary">다음</button>
  					</div>
  				</div>
  				<div class="tab-pane fade" id="contact" role="tabpanel" aria-labelledby="contact-tab">
  					<h3>회원가입 완료 화면</h3>
  					<div class="mt-3">
  						<button id="btn-go-level1" class="btn btn-primary">이전</button>
  					</div>
  				</div>
			</div>
		</div>
	</div>
</div>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
<script type="text/javascript">
$(function() {
	
	// 각각의 탭이 화면에 표시될 때 show.bs.tab 이벤트가 발생함.
	// 각각의 탭이 화면에 표시될 때 브라우져 쿠키에 사용자정의 쿠키값을 저장함
	$("#home-tab").on("show.bs.tab", function() {
		// 브라우저 쿠키에 step=level1 값을 저장하고, 만료시간을 1시간 후로 설정한다.
		setCookie("step", "level1", 1)		
	})
	$("#profile-tab").on("show.bs.tab", function() {
		// 브라우저 쿠키에 step=level2 값을 저장하고, 만료시간을 1시간 후로 설정한다.
		setCookie("step", "level2", 1)		
	})
	$("#contact-tab").on("show.bs.tab", function() {
		// 브라우저 쿠키에 step=level3 값을 저장하고, 만료시간을 1시간 후로 설정한다.
		setCookie("step", "level3", 1)		
	})

	// 다음 버튼을 클릭하면 현재 탭의 다음 탭이 표시된다.
	$("#btn-go-level1").click(function() {
		$("#home-tab").trigger("click");
	});
	
	$("#btn-go-level2").click(function() {
		$("#profile-tab").trigger("click");
	});
	
	$("#btn-go-level3").click(function() {
		$("#contact-tab").trigger("click");
	});
	
	// 브라우져 쿠키에 값을 저장한다.
	// name은 쿠키명, value는 쿠키값, days는 만료일까지의 일 수
	function setCookie(name, value, days) {
		
		var d = new Date();
		d.setTime(d.getTime() + (days*24*60*60*1000));
		var expires = "expires=" + d.toUTCString();
		// 쿠키는 name=value; expires=Thu, 18 Dec 2021 12:00:00 UTC; path=/
		document.cookie = name + "=" + value + ";" + expires + ";path=/";
	};
	
	// 브라우져 쿠키저장소에 지정된 이름의 쿠키값을 찾아서 반환한다.
	function getCookie(name) {
		name = name + "=";
		var decodedCookie = decodeURIComponent(document.cookie);
		var items = decodedCookie.split(";");
		for (var i=0; i<items.length; i++) {
			var item = items[i];
			while (item.charAt(0) == ' ') {
				item = item.substring(1);
			}
			if (item.indexOf(name) == 0) {
				return item.substring(name.length, item.length);
			}
		}
		return "";
	};
	
	// 웹 페이지 로딩시 쿠키값을 조회해서 적절한 작업을 수행하는 함수다.
	(function () {
		// 브라우져 쿠키에서 step이라는 이름으로 저장된 쿠키값을 조회한다.
		var step = getCookie("step");
		
		// 웹페이지가 로딩될 때 쿠키값을 사용해서 구현할 내용을 코딩한다.
		if (step == "" || step == "level1") {
			$("#home-tab").trigger('click');
		} else if (step == "level2") {
			$("#profile-tab").trigger('click');
		} else if (step == "level3") {
			$("#contact-tab").trigger('click');
		}
	})();	
})
</script>
</body>
</html>